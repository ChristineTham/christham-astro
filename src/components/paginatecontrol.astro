---
import { Icon } from 'astro-icon'
import type { CollectionEntry } from 'astro:content'
import type { Page } from 'astro'

export interface Props {
  base: string
  page: Page<CollectionEntry<'blog'>>
}

// const { id } = Astro.params
const { base, page } = Astro.props
---

<div class="mt-4 flex items-center flex-col md:flex-row mx-auto container">
  <div class="pb-2 flex flex-row md:pb-0">
    <a
      href={import.meta.env.BASE_URL + 'categories'}
      class="inline-block px-2 py-1 rounded-md text-white bg-rosely9 hover:bg-roselyC text-base md:text-lg"
    >
      Categories
    </a>
    <a
      href={import.meta.env.BASE_URL + 'tags'}
      class="inline-block px-2 py-1 ml-4 rounded-md text-white bg-rosely9 hover:bg-roselyC text-base md:text-lg"
    >
      Tags
    </a>
  </div>
  {
    page.size < page.total && (
      <div class="md:ml-4 pb-1 md:pb-0">
        <nav
          class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px"
          aria-label="Pagination"
        >
          <a
            href={
              page.url.prev
                ? import.meta.env.BASE_URL + page.url.prev.slice(1)
                : '#'
            }
            class:list={[
              'relative inline-flex items-center px-2 py-2 rounded-l-md border text-sm font-medium',
              page.url.prev
                ? 'border-roselyA bg-white text-rosely0 hover:bg-roselyB dark:border-rosely8 dark:bg-rosely0 dark:text-white dark:hover:bg-rosely9'
                : 'border-rosely2 bg-rosely3 text-rosely2 dark:border-rosely2 dark:bg-rosely1 dark:text-rosely2',
            ]}
          >
            <span class="sr-only">Previous</span>
            <Icon class="h-5 w-5" pack="heroicons-solid" name="chevron-left" />
          </a>
          {Array.from({ length: page.lastPage }, (_, index) => index + 1).map(
            i => ((page.lastPage < 10 || [1,2,3,page.currentPage-1,page.currentPage,page.currentPage+1, page.lastPage-2,page.lastPage-1,page.lastPage].includes(i) &&
              <a
                href={base + '/' + (i > 1 ? i : '')}
                aria-current="page"
                class:list={[
                  i == page.currentPage
                    ? 'bg-rosely4 border-roselyA text-white dark:bg-roselyC dark:border-rosely8 dark:text-white font-bold'
                    : 'bg-white border-roselyA text-rosely0 hover:bg-roselyB dark:bg-rosely0 dark:border-rosely8 dark:text-white dark:hover:bg-rosely9',
                  'relative inline-flex items-center px-4 py-2 border text-sm',
                ]}
              >
                {i}
              </a>) ||
              (( page.currentPage > 5 && i == 4) || (page.currentPage == 1 && i == 4) || (page.currentPage < page.lastPage-4 && i == page.currentPage+2)) &&
              <span class="relative inline-flex items-center px-4 py-2 border text-sm bg-rosely3 border-roselyA text-rosely0 dark:bg-rosely1 dark:border-rosely8 dark:text-rosely3">&#8230;</span>
            )
          )}
          <a
            href={
              page.url.next
                ? import.meta.env.BASE_URL + page.url.next.slice(1)
                : '#'
            }
            class:list={[
              'relative inline-flex items-center px-2 py-2 rounded-r-md border text-sm font-medium',
              page.url.next
                ? 'border-roselyA bg-white text-rosely0 hover:bg-roselyB dark:border-rosely8 dark:bg-rosely0 dark:text-white dark:hover:bg-rosely9'
                : 'border-rosely2 bg-rosely3 text-rosely2 dark:border-rosely2 dark:bg-rosely1 dark:text-rosely2',
            ]}
          >
            <span class="sr-only">Next</span>
            <Icon class="h-5 w-5" pack="heroicons-solid" name="chevron-right" />
          </a>
        </nav>
      </div>
    )
  }
  <p class="italic text-rosely7 md:ml-4">Articles {page.start + 1}-{page.end + 1} (total {page.total})</p>
</div>
